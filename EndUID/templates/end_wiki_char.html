<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>Character Wiki</title>
<style>
    {% include '_wiki_base_css.html' %}

    .wiki-header {
        flex-direction: row !important;
        justify-content: space-between;
        align-items: flex-start;
    }

    .header-text {
        display: flex;
        flex-direction: column;
        gap: 12px;
        flex: 1;
        min-width: 0;
    }

    .char-name-row {
        display: flex;
        align-items: center;
        gap: 16px;
    }

    .char-avatar {
        width: 80px;
        height: 80px;
        border-radius: 8px;
        border: 2px solid rgba(255,255,255,0.15);
        object-fit: cover;
        flex-shrink: 0;
    }

    .char-name {
        font-size: 72px;
        font-weight: 700;
        line-height: 1;
        letter-spacing: -2px;
    }

    .char-portrait {
        flex-shrink: 0;
        width: 280px;
        height: 340px;
        overflow: hidden;
        border: 1px solid rgba(255,255,255,0.1);
        background: rgba(0,0,0,0.3);
    }

    .char-portrait img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        object-position: top center;
    }

    .info-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 12px;
    }

    .info-item {
        background: rgba(255,255,255,0.05);
        border: 1px solid rgba(255,255,255,0.08);
        padding: 14px 20px;
        display: flex;
        flex-direction: column;
        gap: 4px;
    }

    .info-label {
        font-size: 13px;
        color: var(--c-subtext);
        font-family: 'JetBrains Mono', monospace;
        letter-spacing: 1px;
    }

    .info-value {
        font-size: 18px;
        font-weight: 600;
        color: var(--c-text);
    }

    .stats-table {
        width: 100%;
        border-collapse: collapse;
    }

    .stats-table th {
        background: rgba(255,230,0,0.1);
        color: var(--c-accent);
        font-family: 'JetBrains Mono', monospace;
        font-size: 13px;
        font-weight: 600;
        padding: 10px 8px;
        text-align: center;
        border-bottom: 2px solid rgba(255,230,0,0.3);
        letter-spacing: 1px;
    }

    .stats-table td {
        padding: 10px 8px;
        text-align: center;
        font-family: 'Oswald', sans-serif;
        font-size: 18px;
        font-weight: 500;
        color: #ddd;
        border-bottom: 1px solid rgba(255,255,255,0.05);
    }

    .stats-table tr:nth-child(even) td {
        background: rgba(255,255,255,0.02);
    }

    .stats-table td:first-child {
        font-family: 'JetBrains Mono', monospace;
        font-size: 14px;
        color: var(--c-subtext);
        font-weight: 500;
    }

    .talent-block {
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        padding: 20px;
        margin-bottom: 12px;
    }

    .talent-name {
        font-size: 20px;
        font-weight: 700;
        margin-bottom: 12px;
        color: var(--c-accent);
    }

    .talent-effect {
        display: flex;
        gap: 12px;
        margin-bottom: 8px;
        align-items: flex-start;
    }

    .effect-phase {
        flex-shrink: 0;
        font-family: 'JetBrains Mono', monospace;
        font-size: 12px;
        font-weight: 700;
        background: rgba(255,255,255,0.1);
        padding: 3px 10px;
        color: var(--c-subtext);
        white-space: nowrap;
    }

    .effect-desc {
        font-size: 15px;
        line-height: 1.6;
        color: #ccc;
    }

    .skill-block {
        background: rgba(255,255,255,0.04);
        border: 1px solid rgba(255,255,255,0.08);
        padding: 20px;
        margin-bottom: 12px;
    }

    .skill-name {
        font-size: 20px;
        font-weight: 700;
        margin-bottom: 10px;
        color: var(--c-text);
        border-left: 4px solid var(--c-accent);
        padding-left: 12px;
    }

    .skill-desc {
        font-size: 15px;
        line-height: 1.7;
        color: #ccc;
        white-space: pre-wrap;
    }

    .bs-item {
        background: rgba(255,255,255,0.03);
        border-left: 3px solid rgba(255,255,255,0.15);
        padding: 12px 16px;
        margin-bottom: 8px;
    }

    .bs-name {
        font-size: 16px;
        font-weight: 700;
        color: var(--c-text);
        margin-bottom: 4px;
    }

    .bs-desc {
        font-size: 14px;
        color: #aaa;
        line-height: 1.5;
    }

    .potential-rank {
        font-family: 'Oswald', sans-serif;
        font-weight: 700;
        font-size: 14px;
        color: var(--c-accent);
        margin-right: 8px;
    }
</style>
</head>
<body>

<div class="bg-layer">
    {% if bg %}
    <img src="{{ bg }}" style="width:100%;height:100%;object-fit:cover;opacity:0.1;mix-blend-mode:overlay;">
    {% endif %}
</div>
<div class="grid-deco"></div>

<div class="container">

    <div class="wiki-header">
        <div class="header-text">
            <div class="rarity">
                {% for _ in range(wiki.rarity) %}
                <span class="rarity-star">★</span>
                {% endfor %}
            </div>
            <div class="char-name-row">
                {% if char_avatar %}
                <img src="{{ char_avatar }}" class="char-avatar">
                {% endif %}
                <div class="char-name">{{ wiki.name }}</div>
            </div>
            <div class="rarity-line r-{{ wiki.rarity }}"></div>
            <div class="tags">
                <div class="tag-box element">
                    {% if property_icon %}<img src="{{ property_icon }}" class="tag-icon">{% endif %}
                    <span>{{ wiki.attribute }}</span>
                </div>
                <div class="tag-box">
                    {% if profession_icon %}<img src="{{ profession_icon }}" class="tag-icon">{% endif %}
                    <span>{{ wiki.profession }}</span>
                </div>
                {% for tag in wiki.tags %}
                <div class="tag-box">
                    <span>{{ tag }}</span>
                </div>
                {% endfor %}
            </div>
        </div>
        {% if char_img %}
        <div class="char-portrait">
            <img src="{{ char_img }}">
        </div>
        {% endif %}
    </div>

    <div>
        <div class="section-title">基础信息 <span class="en">PROFILE</span></div>
        <div class="info-grid">
            <div class="info-item">
                <div class="info-label">阵营</div>
                <div class="info-value">{{ wiki.faction or '-' }}</div>
            </div>
            <div class="info-item">
                <div class="info-label">种族</div>
                <div class="info-value">{{ wiki.race or '-' }}</div>
            </div>
            {% if wiki.specialties %}
            <div class="info-item">
                <div class="info-label">专长</div>
                <div class="info-value">{{ wiki.specialties | join('、') }}</div>
            </div>
            {% endif %}
            {% if wiki.hobbies %}
            <div class="info-item">
                <div class="info-label">爱好</div>
                <div class="info-value">{{ wiki.hobbies | join('、') }}</div>
            </div>
            {% endif %}
            {% if wiki.operator_preference %}
            <div class="info-item">
                <div class="info-label">干员偏好</div>
                <div class="info-value">{{ wiki.operator_preference }}</div>
            </div>
            {% endif %}
            {% if wiki.release_date %}
            <div class="info-item">
                <div class="info-label">实装日期</div>
                <div class="info-value">{{ wiki.release_date }}</div>
            </div>
            {% endif %}
        </div>
    </div>

    {% if wiki.stats %}
    <div>
        <div class="section-title">能力值 <span class="en">ATTRIBUTES</span></div>
        <table class="stats-table">
            <tr>
                <th>等级</th>
                <th>力量</th>
                <th>敏捷</th>
                <th>智识</th>
                <th>意志</th>
                <th>攻击</th>
                <th>生命</th>
                <th>防御</th>
            </tr>
            {% for s in wiki.stats %}
            <tr>
                <td>{{ s.level }}</td>
                <td>{{ s.strength }}</td>
                <td>{{ s.agility }}</td>
                <td>{{ s.intelligence }}</td>
                <td>{{ s.will }}</td>
                <td>{{ s.base_attack }}</td>
                <td>{{ s.base_hp }}</td>
                <td>{{ s.base_defense }}</td>
            </tr>
            {% endfor %}
        </table>
    </div>
    {% endif %}

    {% if wiki.talents %}
    <div>
        <div class="section-title">天赋 <span class="en">TALENTS</span></div>
        {% for talent in wiki.talents %}
        <div class="talent-block">
            <div class="talent-name">{{ talent.name }}</div>
            {% for eff in talent.effects %}
            {% if eff.description %}
            <div class="talent-effect">
                <div class="effect-phase">{{ eff.phase }}</div>
                <div class="effect-desc">{{ eff.description }}</div>
            </div>
            {% endif %}
            {% endfor %}
        </div>
        {% endfor %}
    </div>
    {% endif %}

    {% if wiki.skills %}
    <div>
        <div class="section-title">技能 <span class="en">SKILLS</span></div>
        {% for skill in wiki.skills %}
        <div class="skill-block">
            <div class="skill-name">{{ skill.name }}</div>
            <div class="skill-desc">{{ skill.description }}</div>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    {% if wiki.base_skills %}
    <div>
        <div class="section-title">后勤技能 <span class="en">BASE SKILLS</span></div>
        {% for bs in wiki.base_skills %}
        <div class="bs-item">
            <div class="bs-name">{{ bs.name }}</div>
            <div class="bs-desc">{{ bs.description }}</div>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    {% if wiki.potentials %}
    <div>
        <div class="section-title">潜能 <span class="en">POTENTIALS</span></div>
        {% for p in wiki.potentials %}
        <div class="bs-item">
            <div class="bs-name">
                <span class="potential-rank">P{{ p.rank }}</span>
                {{ p.name }}
            </div>
            <div class="bs-desc">{{ p.description }}</div>
        </div>
        {% endfor %}
    </div>
    {% endif %}

    <div class="wiki-footer">
        {% if end_logo %}
        <img src="{{ end_logo }}" class="footer-logo">
        {% endif %}
        <div class="footer-text">ENDFIELD WIKI</div>
    </div>

</div>
</body>
</html>
